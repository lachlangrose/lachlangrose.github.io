.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_3_multiple_groups.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_plot_3_multiple_groups.py:


3. Multiple groups
===================
Creating a model with multiple geological features, dealing with unconformities.




.. image:: /auto_examples/images/sphx_glr_plot_3_multiple_groups_001.png
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Isovalue doesn't exist inside bounding box
    Isovalue doesn't exist inside bounding box
    /home/lgrose/dev/python/LoopStructural/LoopStructural/interpolators/structured_tetra.py:178: RuntimeWarning: invalid value encountered in greater
      mask = np.all(c > 0, axis=2)
    /home/lgrose/dev/python/LoopStructural/LoopStructural/modelling/features/unconformity_feature.py:34: RuntimeWarning: invalid value encountered in less
      return self.feature.evaluate_value(pos) < self.value






|


.. code-block:: default

    from LoopStructural import GeologicalModel
    from LoopStructural.datasets import load_claudius
    from LoopStructural.visualisation import LavaVuModelViewer

    import pandas as pd
    import numpy as np

    data, bb = load_claudius()
    data = data.reset_index()

    data.loc[:,'val']*=-1
    data.loc[:,['nx','ny','nz']]*=-1

    data.loc[792,'type'] = 'strati2'
    data.loc[792,['nx','ny','nz']] = [0,0,1]
    data.loc[792,'val'] = 0

    model = GeologicalModel(bb[0,:],bb[1,:])
    model.set_model_data(data)

    strati2 = model.create_and_add_foliation('strati2',
                                  interpolatortype='PLI',
                                   nelements=1e4,
                                   solver='pyamg'
                                  )
    uc = model.add_unconformity(strati2['feature'],1)

    strati = model.create_and_add_foliation('strati',
                                  interpolatortype='PLI',
                                   nelements=1e4,
                                   solver='pyamg'
                                  )

    viewer = LavaVuModelViewer(model)
    viewer.add_isosurface(strati2['feature'],
    #                       nslices=5
                          slices=[2,1.5,1],
                         )
    viewer.add_isosurface(strati['feature'],
                          slices=[0,-60,-250,-330],
                         paint_with=strati['feature'])
    viewer.rotate([-85.18760681152344, 42.93233871459961, 0.8641873002052307])
    viewer.display()

.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  2.700 seconds)


.. _sphx_glr_download_auto_examples_plot_3_multiple_groups.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_3_multiple_groups.py <plot_3_multiple_groups.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_3_multiple_groups.ipynb <plot_3_multiple_groups.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
